name: Update baseline
on:
    workflow_dispatch:
    schedule:
        - cron: "0 0 * * 0" # Runs every Sunday at midnight UTC

jobs:
    update-baseline:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v6
            - name: Setup Node.js
              uses: actions/setup-node@v6
              with:
                  node-version: "lts/*"

            - name: Install dependencies
              run: npm install

            - name: Update baseline packages
              run: npm install -D mdn-data@latest web-features@latest

            - name: Generate baseline data
              run: npm run build:baseline

            - name: Create Pull Request
              uses: peter-evans/create-pull-request@22a9089034f40e5a961c8808d113e2c98fb63676 # v7
              with:
                  token: ${{ secrets.WORKFLOW_PUSH_BOT_TOKEN }}
                  commit-message: "fix: update baseline data"
                  title: "fix: update baseline data"
                  branch: update-baseline-data
                  branch-suffix: timestamp
                  body: |
                      Updates baseline data using the latest versions of mdn-data and web-features.

                      This PR is autogenerated by the "Update Baseline" GitHub Action.
